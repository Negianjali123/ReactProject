var sharedClipboard;!function(){"use strict";var e={494:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.promises=function(){return void 0===r[n]&&(r[n]="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&"function"==typeof Promise.resolve(0).then),r[n]};const r={},n="promises"},264:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=function(){const e=new Uint8Array(31),t=function(e){const t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof crypto?crypto:"undefined"!=typeof msCrypto?msCrypto:void 0;if(r){t.crypto=!0;try{return r.getRandomValues(e),t}catch(e){t.exceptions.push(`crypto: ${JSON.stringify(e)}`)}}let n=!1;const o="undefined"!=typeof performance?performance:void 0;try{o&&o.now&&o.now()!==1/0&&(n=!0)}catch(e){t.exceptions.push(`perfNow: ${JSON.stringify(e)}`)}for(let r=0;r<e.length;r+=1){try{if(n){t.perfNow=!0;let e=Math.floor(100*o.now())%10;(e<0||e>9)&&(e=0);for(let t=0;t<e;t+=1)Math.random()}}catch(e){t.exceptions.push(`Math.random: ${JSON.stringify(e)}`)}e[r]=Math.floor(16*Math.random())}return t}(e);let r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const n=15&e[r];return r+=1,("x"===t?n:3&n|8).toString(16)})),t]}},332:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isReplaceChildrenSupported=t.replaceChildren=void 0,t.replaceChildren=e=>{if(e)if((0,t.isReplaceChildrenSupported)(e))e.replaceChildren();else for(;e.lastChild;)e.removeChild(e.lastChild)},t.isReplaceChildrenSupported=e=>!!e.replaceChildren},657:function(e,t,r){Object.defineProperty(t,"BJ",{value:!0}),t.RR=t.UX=t.Cr=t.Cy=t.TZ=t.we=t.nh=t.kp=t.Hv=t.Wp=t.WM=t.ke=t.bj=t.kA=void 0;const n=r(988);t.Wp=n;const o=r(633);Object.defineProperty(t,"Hv",{enumerable:!0,get:function(){return o.ULS}}),Object.defineProperty(t,"kp",{enumerable:!0,get:function(){return o.TraceLevel}}),Object.defineProperty(t,"nh",{enumerable:!0,get:function(){return o.LogCategory}}),Object.defineProperty(t,"Cy",{enumerable:!0,get:function(){return o.NulLogger}}),Object.defineProperty(t,"Cr",{enumerable:!0,get:function(){return o.ConsoleLogger}});const i=r(494);t.we=i;const a=r(935);t.TZ=a;const s=r(722);Object.defineProperty(t,"UX",{enumerable:!0,get:function(){return s.initStopwatchFactory}});const l=r(235);Object.defineProperty(t,"RR",{enumerable:!0,get:function(){return l.TelemetryCollector}});var c=r(264);Object.defineProperty(t,"kA",{enumerable:!0,get:function(){return c.getNewGuid}});var d=r(251);Object.defineProperty(t,"bj",{enumerable:!0,get:function(){return d.TextAreaVirtualKeyboardPolicy}}),Object.defineProperty(t,"ke",{enumerable:!0,get:function(){return d.TextAreaInputMode}});var u=r(332);Object.defineProperty(t,"WM",{enumerable:!0,get:function(){return u.replaceChildren}})},633:function(e,t){var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r||(t.TraceLevel=r={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(n||(t.LogCategory=n={})),t.ULS={getFromExternalLogger:function(e){const t=e;return{ULS:{trace:(e,r,n)=>t.traceTag(0,e,r,n),traceTag:(e,r,n,o)=>t.traceTag(e,r,n,o),debugTrace:(e,r,n)=>t.debugTraceTag(0,e,r,n),debugTraceTag:(e,r,n,o)=>t.debugTraceTag(e,r,n,o),assert:(e,r,n)=>t.assertTag(0,e,r,n),assertTag:(e,r,n,o)=>t.assertTag(e,r,n,o),shipAssert:(e,r,n)=>t.shipAssertTag(0,e,r,n),shipAssertTag:(e,r,n,o)=>t.shipAssertTag(e,r,n,o),dnmTrace:(e,r,n)=>t.dnmTraceTag(0,e,r,n),dnmTraceTag:(e,r,n,o)=>t.dnmTraceTag(e,r,n,o)}}}},t.ConsoleLogger=class{shipAssertTag(e,t,r,n){console.assert(r,"shipAssertTag:",e,t,n)}assertTag(e,t,r,n){console.assert(r,"assertTag",e,t,n)}traceTag(e,t,r,n){console.log("traceTag",e,n,t,r)}dnmTraceTag(e,t,r,n){console.log("dnmTraceTag",e,n,t,r)}debugTraceTag(e,t,r,n){console.log("debugTraceTag",e,n,t,r)}},t.NulLogger=class{shipAssertTag(){}assertTag(){}traceTag(){}debugTraceTag(){}dnmTraceTag(){}}},935:function(e,t){function r(){const e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function n(e,t,n){e[t]=r()-n}Object.defineProperty(t,"__esModule",{value:!0}),t.start=function(e){const t=r(),o=e,i=t,a={},s=(e,t,r)=>function(e,t,r,o,i,a){n(e,"end",r);const s={sessionName:t,result:o?"success":"failure",message:a,marks:e};i(JSON.stringify(s))}(a,o,i,e,t,r);return a.start=0,{mark:e=>(e=>n(a,e,i))(e),end:e=>s(!0,e),success:(e,t)=>s(!0,e,t),failure:(e,t)=>s(!1,e,t)}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=r},251:function(e,t){var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(r||(t.TextAreaVirtualKeyboardPolicy=r={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(n||(t.TextAreaInputMode=n={}))},722:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=function(e,t=1){return"undefined"!=typeof self&&self.performance&&self.performance.now&&(r=()=>self.performance.now()),function(n){let o=r(),i=n;return{reset(e){null!=e&&(i=e),o=r()},stop(n){const a=r()-o,s=JSON.stringify({Target:i,Duration:a.toFixed(t),StopInfo:n});e(s)}}}};let r=()=>Date.now()},235:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0,t.TelemetryCollector=class{getJsonForLogging(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"}addEvent(e,t){null!=e&&null!=t&&(this.events[e]=t)}clearEvents(){this.events={}}getEventsLoggableString(){return JSON.stringify(this.events)}incrementCounter(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)}getCountersLoggableString(){return JSON.stringify(this.counters)}clearCounters(){this.counters={}}startTimer(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})}endTimer(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)}getTimerDuration(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"}getTimersLoggableString(){return JSON.stringify(this.timers)}constructor(){this.counters={},this.timers={},this.events={}}}},988:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.defaultToJSONResultWhenStringifyFails=void 0,t.forEachPromise=function(e,t,r){return e.reduce(((e,n)=>e.then((()=>r&&r.stop?Promise.resolve(void 0):t(n,r)))),Promise.resolve(void 0))},t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(n(e))}catch{return t.defaultToJSONResultWhenStringifyFails}},t.getPerfWatchMarkName=function(e){if(!e)return"";let t=e.trim().substring(0,200).trim().replace(i,o).substring(0,80);return t&&t.length>0&&t.substr(t.length-1,1)===o&&(t=t.substr(0,t.length-1)),t&&t.length>0&&t.substr(0,1)===o&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error(`utils.retry: attempts expected to be greater than 0 but got ${t}`));let r=Promise.reject();for(let n=1;n<=t;n+=1)r=r.catch((t=>e(n,t)));return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();let r=t(e[0]);for(let n=1;n<e.length;n+=1){const o=e[n];r=r.catch((()=>t(o)))}return r},t.getQueryParameterByName=function(e,t){const r=new RegExp(`[?&]${t}(=([^&#]*)|&|#|$)`).exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;let t=5381,r=t;const n=e.length;for(let o=0;o<n&&(t=4294967295&((t<<5)+t^e.charCodeAt(o)),o!==n-1);o+=2)r=4294967295&((r<<5)+r^e.charCodeAt(o+1));let o=t+35685*r+(23896*r<<16)&4294967295;return o<0&&(o+=4294967296),o},t.defaultToJSONResultWhenStringifyFails="...";const r=5;function n(e,t=0){if(t<0||t>r)return e;if(null==e||"object"!=typeof e)return e;const o={};Object.getOwnPropertyNames(e).forEach((t=>{"stack"!==t&&t.toUpperCase()!==t&&(o[t]=e[t])}));const i=Object.getPrototypeOf(e);i&&"object"==typeof i&&Object.keys(i).forEach((t=>{"stack"!==t&&t.toUpperCase()!==t&&(o[t]=e[t])}));const a={};return Object.keys(o).forEach((e=>{a[e]=n(o[e],t+1)})),a}const o="_",i=new RegExp("\\W+","g")},849:function(e,t){function r(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.getChangeGateDictionary=r,t.isChangeGateEnabled=function(e){return r()[e]??!0},t.setChangeGateDictionaryGetter=function(e){const t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},645:function(e,t){function r(e){return e.split("")}Object.defineProperty(t,"__esModule",{value:!0}),t.editDistance=function(e,t){const n=r(e),o=r(t);let i=[];for(let e=0;e<=o.length;++e)i[e]=e;for(let e=1;e<=n.length;++e){const t=[e];for(let r=1;r<=o.length;++r)t[r]=n[e-1]===o[r-1]?i[r-1]:1+Math.min(i[r],i[r-1],t[r-1]);i=t}return i[o.length]}},230:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.disableVerboseMode=function(){globalThis.__office_online_feature_gates_verbose_log_callback=void 0},t.enableVerboseMode=function(e){globalThis.__office_online_feature_gates_verbose_log_callback=e},t.getFeatureGateDictionary=i,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){const r=a(e)?.trim().toLowerCase();return"true"===r||"false"!==r&&t},t.getNumberFeatureGate=function(e,t){const r=a(e)?.trim().toLowerCase();if(void 0===r)return t;if("infinity"===r||"+infinity"===r)return 1/0;if("-infinity"===r)return-1/0;const n=parseFloat(r);return isNaN(n)?t:n},t.getIntFeatureGate=function(e,t){const r=a(e)?.trim();if(void 0===r)return t;const n=parseInt(r,10);return isNaN(n)?t:n},t.setFeatureGateDictionaryGetter=function(e){const t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t};const n=r(645),o={};function i(){return void 0===globalThis.__get_feature_gate_dictionary_variable?o:globalThis.__get_feature_gate_dictionary_variable()}function a(e,t){if(void 0===globalThis.__office_online_feature_gates_verbose_log_callback)return i()[e]??t;const r=i();if(Object.hasOwn(r,e))return r[e]??t;const o=globalThis.__office_online_feature_gates_verbose_log_callback;o(`Failed lookup for FeatureGate ${e}...`);const a=[],s=e.toLowerCase();for(const e of Object.keys(r))(0,n.editDistance)(e.toLowerCase(),s)<=4&&a.push(e);return a.length>0&&o(`Potential candidates found (edit distance <= 4, case-insensitive): [${a.join(", ")}]`),o(`FeatureGate override not found, returning default: ${t}`),t}},382:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});const n=r(533);n.__exportStar(r(230),t),n.__exportStar(r(137),t),n.__exportStar(r(849),t),n.__exportStar(r(482),t),n.__exportStar(r(910),t),n.__exportStar(r(222),t)},137:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=function(e){return function(t){const r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}};const n=r(230)},482:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=function(e){return e=>(0,n.isChangeGateEnabled)(e)};const n=r(849)},910:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.overrideChangeGates=o,t.overrideTypedChangeGates=function(e,t){return o(t)};const n=r(849);function o(e){const t=(0,n.setChangeGateDictionaryGetter)(void 0);return(0,n.setChangeGateDictionaryGetter)((()=>({...void 0!==t?t():{},...e}))),t}},222:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.overrideFeatureGates=o,t.overrideTypedFeatureGates=function(e,t){return o(t)};const n=r(230);function o(e){const t={};for(const r of Object.keys(e))t[r]=e[r]?.toString();const r=(0,n.setFeatureGateDictionaryGetter)(void 0)??(()=>({}));return(0,n.setFeatureGateDictionaryGetter)((()=>({...r(),...t}))),r}},533:function(e,t,r){r.r(t),r.d(t,{__addDisposableResource:function(){return k},__assign:function(){return i},__asyncDelegator:function(){return T},__asyncGenerator:function(){return E},__asyncValues:function(){return I},__await:function(){return v},__awaiter:function(){return h},__classPrivateFieldGet:function(){return O},__classPrivateFieldIn:function(){return x},__classPrivateFieldSet:function(){return W},__createBinding:function(){return m},__decorate:function(){return s},__disposeResources:function(){return F},__esDecorate:function(){return c},__exportStar:function(){return w},__extends:function(){return o},__generator:function(){return f},__importDefault:function(){return L},__importStar:function(){return M},__makeTemplateObject:function(){return P},__metadata:function(){return g},__param:function(){return l},__propKey:function(){return u},__read:function(){return b},__rest:function(){return a},__runInitializers:function(){return d},__setFunctionName:function(){return p},__spread:function(){return y},__spreadArray:function(){return _},__spreadArrays:function(){return C},__values:function(){return S},default:function(){return $}});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function s(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function l(e,t){return function(r,n){t(r,n,e)}}function c(e,t,r,n,o,i){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,l=n.kind,c="getter"===l?"get":"setter"===l?"set":"value",d=!t&&e?n.static?e:e.prototype:null,u=t||(d?Object.getOwnPropertyDescriptor(d,n.name):{}),p=!1,g=r.length-1;g>=0;g--){var h={};for(var f in n)h[f]="access"===f?{}:n[f];for(var f in n.access)h.access[f]=n.access[f];h.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(e||null))};var m=(0,r[g])("accessor"===l?{get:u.get,set:u.set}:u[c],h);if("accessor"===l){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(s=a(m.get))&&(u.get=s),(s=a(m.set))&&(u.set=s),(s=a(m.init))&&o.unshift(s)}else(s=a(m))&&("field"===l?o.unshift(s):u[c]=s)}d&&Object.defineProperty(d,n.name,u),p=!0}function d(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function u(e){return"symbol"==typeof e?e:"".concat(e)}function p(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function g(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function h(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{l(n.next(e))}catch(e){i(e)}}function s(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))}function f(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}var m=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function w(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||m(t,e,r)}function S(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(b(arguments[t]));return e}function C(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}function _(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function v(e){return this instanceof v?(this.v=e,this):new v(e)}function E(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||s(e,t)}))})}function s(e,t){try{(r=o[e](t)).value instanceof v?Promise.resolve(r.value.v).then(l,c):d(i[0][2],r)}catch(e){d(i[0][3],e)}var r}function l(e){s("next",e)}function c(e){s("throw",e)}function d(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}function T(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:v(e[n](t)),done:!1}:o?o(t):t}:o}}function I(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=S(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,o,(t=e[r](t)).done,t.value)}))}}}function P(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var A=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function M(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&m(t,e,r);return A(t,e),t}function L(e){return e&&e.__esModule?e:{default:e}}function O(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function W(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function x(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function k(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if("function"!=typeof n)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var D="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function F(e){function t(t){e.error=e.hasError?new D(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var n=e.stack.pop();try{var o=n.dispose&&n.dispose.call(n.value);if(n.async)return Promise.resolve(o).then(r,(function(e){return t(e),r()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const $={__extends:o,__assign:i,__rest:a,__decorate:s,__param:l,__metadata:g,__awaiter:h,__generator:f,__createBinding:m,__exportStar:w,__values:S,__read:b,__spread:y,__spreadArrays:C,__spreadArray:_,__await:v,__asyncGenerator:E,__asyncDelegator:T,__asyncValues:I,__makeTemplateObject:P,__importStar:M,__importDefault:L,__classPrivateFieldGet:O,__classPrivateFieldSet:W,__classPrivateFieldIn:x,__addDisposableResource:k,__disposeResources:F}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};r.r(n),r.d(n,{ConsoleLogger:function(){return o.Cr},LogCategory:function(){return o.nh},NulLogger:function(){return o.Cy},TelemetryCollector:function(){return o.RR},TextAreaInputMode:function(){return o.ke},TextAreaVirtualKeyboardPolicy:function(){return o.bj},TraceLevel:function(){return o.kp},ULS:function(){return o.Hv},__esModule:function(){return o.BJ},browserSupport:function(){return o.we},getNewGuid:function(){return o.kA},initStopwatchFactory:function(){return o.UX},initialize:function(){return ut},perfWatch:function(){return o.TZ},replaceChildren:function(){return o.WM},utils:function(){return o.Wp}});var o=r(657);let i;function a(){return i}function s(e){if(!e)throw new Error("The 'logger' argument is missing");i=o.Hv.getFromExternalLogger(e)}const l="";var c,d,u,p,g,h;function f(e){if(e&&"object"==typeof e){if(m(e.reason))return!0;if(e.innerError&&"string"==typeof e.innerError)try{if(m(JSON.parse(e.innerError).reason))return!0}catch{}}if("string"==typeof e)try{if(m(JSON.parse(e).reason))return!0}catch{}return!1}function m(e){return e===d.LocalStorageInitilizationInaccessible}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.FullAccessClipboardAndInMemory=3]="FullAccessClipboardAndInMemory",e[e.InMemory=4]="InMemory",e[e.LocalStorage=5]="LocalStorage",e[e.SystemClipboardAndLocalStorage=6]="SystemClipboardAndLocalStorage",e[e.SystemClipboardAndInMemory=7]="SystemClipboardAndInMemory",e[e.AsyncSystemClipboard=8]="AsyncSystemClipboard",e[e.AsyncSystemClipboardAndLocalStorage=9]="AsyncSystemClipboardAndLocalStorage",e[e.AsyncSystemClipboardAndInMemory=10]="AsyncSystemClipboardAndInMemory"}(c||(c={})),(u=d||(d={}))[u.UnsupportedClipboardStrategyType=0]="UnsupportedClipboardStrategyType",u[u.UnsupportedClipboardStorageType=1]="UnsupportedClipboardStorageType",u[u.ClipboardIsInaccessible=2]="ClipboardIsInaccessible",u[u.SetClipboardItems=3]="SetClipboardItems",u[u.GetClipboardItems=5]="GetClipboardItems",u[u.NoGetOperationResultMessage=7]="NoGetOperationResultMessage",u[u.NoSetOperationResultMessage=8]="NoSetOperationResultMessage",u[u.ClearClipboardItems=9]="ClearClipboardItems",u[u.MissingBrowserExtensionCapability=10]="MissingBrowserExtensionCapability",u[u.NoBrowserExtensionsInConfiguration=11]="NoBrowserExtensionsInConfiguration",u[u.NoAvailableBrowserExtensions=12]="NoAvailableBrowserExtensions",u[u.UnavailableBrowserExtension=13]="UnavailableBrowserExtension",u[u.NoBrowserExtensionWithGetClipboardDataCommand=14]="NoBrowserExtensionWithGetClipboardDataCommand",u[u.SelectClipboardStrategy=15]="SelectClipboardStrategy",u[u.IframeInitialization=16]="IframeInitialization",u[u.UnsupportedOperationCode=26]="UnsupportedOperationCode",u[u.RejectingPendingPastePromiseDueToNewPasteOperation=27]="RejectingPendingPastePromiseDueToNewPasteOperation",u[u.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation=28]="RejectingPendingCutCopyPromiseDueToNewCutCopyOperation",u[u.RejectingBlockedSyncCutCopyPromise=29]="RejectingBlockedSyncCutCopyPromise",u[u.IframeInitializationTimeout=30]="IframeInitializationTimeout",u[u.ClipboardStrategyNotInitialized=33]="ClipboardStrategyNotInitialized",u[u.UnexpectedClipboardTextHtmlContentLength=34]="UnexpectedClipboardTextHtmlContentLength",u[u.InvalidClipboardStrategyType=35]="InvalidClipboardStrategyType",u[u.CreateWindowRPCServer=36]="CreateWindowRPCServer",u[u.RefreshMetadata=37]="RefreshMetadata",u[u.DeserializedMetadata=38]="DeserializedMetadata",u[u.SerializedMetadata=39]="SerializedMetadata",u[u.LocalStorageInitilizationInaccessible=40]="LocalStorageInitilizationInaccessible",u[u.LocalStorageInitilizationNoKey=41]="LocalStorageInitilizationNoKey",u[u.IframeProxyGeneralError=42]="IframeProxyGeneralError",u[u.IframeProxyEmptyResultMessage=43]="IframeProxyEmptyResultMessage",u[u.AsyncClipboardReadFailure=44]="AsyncClipboardReadFailure",u[u.AsyncClipboardWriteFailure=45]="AsyncClipboardWriteFailure",function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.CopyFlowHandlerNotFound=1]="CopyFlowHandlerNotFound",e[e.FetchCopyFlowHandlerFailed=2]="FetchCopyFlowHandlerFailed",e[e.FetchSourceItemFailed=3]="FetchSourceItemFailed",e[e.BeforeSerializeFailed=4]="BeforeSerializeFailed",e[e.SerializeFailed=5]="SerializeFailed",e[e.SerializeResultNotValid=6]="SerializeResultNotValid",e[e.AsyncSerializeFailed=7]="AsyncSerializeFailed",e[e.SaveToTheClipboardFailed=8]="SaveToTheClipboardFailed",e[e.InspectClipboardFailed=9]="InspectClipboardFailed",e[e.ClipboardIsInaccessible=10]="ClipboardIsInaccessible",e[e.SuccessiveCutCopyOverridingPendingCutCopy=11]="SuccessiveCutCopyOverridingPendingCutCopy",e[e.BlockedSynchronousCutCopy=12]="BlockedSynchronousCutCopy",e[e.CopyOperationCancelled=13]="CopyOperationCancelled",e[e.UnknownCopyErrorType=14]="UnknownCopyErrorType"}(p||(p={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.PasteFlowHandlerNotFound=1]="PasteFlowHandlerNotFound",e[e.FetchPasteFlowHandlerFailed=2]="FetchPasteFlowHandlerFailed",e[e.FailedToReadFromClipboard=3]="FailedToReadFromClipboard",e[e.InspectClipboardFailed=4]="InspectClipboardFailed",e[e.ReadFromClipboardReturnNullOrUndefined=5]="ReadFromClipboardReturnNullOrUndefined",e[e.ClipboardIsEmpty=6]="ClipboardIsEmpty",e[e.DeserializeOperationFailed=7]="DeserializeOperationFailed",e[e.ClipboardIsInaccessible=8]="ClipboardIsInaccessible",e[e.SuccessivePasteOverridingPendingPaste=9]="SuccessivePasteOverridingPendingPaste",e[e.FileReaderResultIsEmpty=10]="FileReaderResultIsEmpty",e[e.FileReaderFailed=11]="FileReaderFailed",e[e.UnknownPasteError=12]="UnknownPasteError",e[e.DeferredPasteRejectedBecauseOtherCopyCompleted=13]="DeferredPasteRejectedBecauseOtherCopyCompleted",e[e.DeferredPasteRejectedBecauseOtherCopyStarted=14]="DeferredPasteRejectedBecauseOtherCopyStarted",e[e.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext=15]="DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext",e[e.FailedToReadFromAsyncClipboard=16]="FailedToReadFromAsyncClipboard"}(g||(g={})),function(e){e[e.FailedToClearClipboard=0]="FailedToClearClipboard"}(h||(h={}));class w extends Error{static augmentParameterValue(e){return e&&"string"==typeof e?e.trim():l}constructor(e,t,r){const n=w.augmentParameterValue(e);if(super(n),this.name=w.augmentParameterValue(t),this.errorName=this.name,this.name?a().ULS.traceTag(596456211,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`Error '${this.name}': ${n}`):a().ULS.traceTag(596456212,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`Error message: ${n}`),r){this.innerError=r;let e=this.innerError.message;e||(e=this.innerError.name);const t=w.augmentParameterValue(e);t.length>0&&a().ULS.traceTag(596456213,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`Inner error message: ${t}`)}this.stack||(this.stack=(new Error).stack)}}class S extends w{constructor(e,t){super(e,"NoValidKeyError",t)}}class b extends w{static getDefaultMessage(e){let t="Missing argument";return e.length>0&&(t=`Missing argument: '${e}'`),t}constructor(e,t,r){const n=w.augmentParameterValue(t),o=b.getDefaultMessage(n);let i=w.augmentParameterValue(e);0===i.length&&(i=o),super(i,"MissingArgumentError",r),this.name=n}}class y extends w{static getDefaultMessage(e,t){return e.length>0?`Invalid '${e}' argument: '${t}'`:"Invalid argument"}constructor(e,t,r,n){const o=w.augmentParameterValue(t);let i=r;i||(i=l);const a=y.getDefaultMessage(o,i);let s=w.augmentParameterValue(e);0===e.length&&(s=a),super(s,"InvalidArgumentError",n),this.name=o,this.value=i}}class C extends w{constructor(e,t){super(e,"InvalidOperationError",t)}}class _ extends w{constructor(e,t,r,n,o){super(t||`reason=${e}`,r,n),this.reason=e,o&&(this.errorName=o)}}class v extends _{constructor(e,t,r){var n,o;super(e,t,"ClipboardPlatformError",r,function(e,t){return void 0!==e&&"number"==typeof e&&e>=0&&e<Object.keys(t).length/2}(n=e,o=d)?o[n]:l)}}new RegExp("(\\bTrident/| MSIE )");const E=(e,t,r,n)=>{e.postMessage(t,r,n)},T="text/plain",I=function(){const e={items:{}};return{getData:()=>e,getItem:e=>{},setItem:(e,t)=>{throw new C(`Cannot set an item with clipboard data format '${e}' in an immutable empty clipboard (content is ${t&&t.length>0?"not ":l}empty)`)},setDeferredItem:(e,t)=>{throw new C(`Cannot set a deferred item with clipboard data format '${e}' in an immutable empty clipboard`)},hasDeferredItem:e=>!1,getDeferredItem:e=>{},get:()=>W(void 0)}}();function P(){return I}function A(e){return e&&e.items?Object.keys(e.items).length:0}function M(e){return A(e&&e.getData())}function L(e=void 0){let t=e;t||(t={items:{}});const r={getItem:e=>function(e,t){if(!e)throw new b(l,"clipboardItemsData");if(!e.items)throw new y(l,"clipboardItemsData.items");const r=e.items[t];if(!(r&&r instanceof Promise))return r}(t,e),setItem:(e,r)=>{O(t,e,r)},setDeferredItem:(e,r)=>{O(t,e,r)},hasDeferredItem:e=>{if(!t||!t.items)return!1;const r=t.items[e];return!!r&&r instanceof Promise},getDeferredItem:e=>function(e,t){if(!e)throw new b(l,"clipboardItemsData");if(!e.items)throw new y(l,"clipboardItemsData.items");const r=e.items[t];return!r||r instanceof Promise?r:Promise.resolve(new Blob([r],{type:T}))}(t,e),getData:()=>t,get:()=>W(t)};return r}function O(e,t,r){if(!e)throw new b(l,"clipboardItemsData");if(!e.items)throw new y(l,"clipboardItemsData.items");e.items[t]=r}function W(e){const t=[];if(0===A(e))return t;for(const r in e.items){let n=e.items[r];n||(n=l);const o={clipboardDataFormat:r,data:n,deferred:n instanceof Promise};t.push(o)}return t}var x,k,D;!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.InMemory=2]="InMemory",e[e.LocalStorage=3]="LocalStorage",e[e.AsyncSystemClipboard=4]="AsyncSystemClipboard"}(x||(x={})),function(e){e[e.None=0]="None",e[e.Cut=1]="Cut",e[e.Copy=2]="Copy",e[e.Paste=4]="Paste",e[e.Values=16]="Values",e[e.Formatting=32]="Formatting",e[e.Formulas=64]="Formulas",e[e.DragDropCells=128]="DragDropCells",e[e.DragDropNoErrMsg=256]="DragDropNoErrMsg",e[e.Transpose=512]="Transpose",e[e.Link=1024]="Link",e[e.PictureInCell=2048]="PictureInCell",e[e.ColumnWidths=4096]="ColumnWidths",e[e.Copilot=8192]="Copilot",e[e.PasteValues=20]="PasteValues",e[e.PasteFormatting=36]="PasteFormatting",e[e.PasteFormulas=68]="PasteFormulas",e[e.PasteTranspose=516]="PasteTranspose",e[e.PasteLink=1028]="PasteLink",e[e.PastePictureInCell=2052]="PastePictureInCell",e[e.PasteWithColumnWidths=4100]="PasteWithColumnWidths",e[e.PasteWithCopilot=8196]="PasteWithCopilot"}(k||(k={})),function(e){e[e.NoError=0]="NoError",e[e.LocalStorageInaccessible=1]="LocalStorageInaccessible"}(D||(D={}));const F="BulsEndpointUrl",$="usid",R="-",j="sharedClipboardSettings",U=1,J=3600,N=2;let H=B(),z=!1;function V(){if(!z)throw new C("First initialize the settings via initializeSharedClipboardSettingsFromWindow() or initializeSharedClipboardSettings()");return H}function G(){z=!1,function(){if(!window||!(j in window))return H=B(),void(z=!0);const e=window[j];if(!e||"object"!=typeof e)return H=B(),void(z=!0);!function(e){if(!e)throw new b(l,"sharedClipboardSettingsCandidate");const t=B();if("number"!=typeof e.sharedClipboardSchemaVersion||isNaN(e.sharedClipboardSchemaVersion)||(t.sharedClipboardSchemaVersion=e.sharedClipboardSchemaVersion),"number"!=typeof e.sharedClipboardExpirationInMinutes||isNaN(e.sharedClipboardExpirationInMinutes)||(t.sharedClipboardExpirationInMinutes=e.sharedClipboardExpirationInMinutes),"number"!=typeof e.clipboardPromiseTimeoutInMinutes||isNaN(e.clipboardPromiseTimeoutInMinutes)||(t.clipboardPromiseTimeoutInMinutes=e.clipboardPromiseTimeoutInMinutes),"string"==typeof e.remoteLoggerPath&&e.remoteLoggerPath&&e.remoteLoggerPath.trim()&&(t.remoteLoggerPath=e.remoteLoggerPath),"number"!=typeof e.whitelistOriginComponents||1!==e.whitelistOriginComponents)return H=t,void(z=!0);if("string"!=typeof e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp.trim())return a().ULS.traceTag(596124181,o.nh.msoulscat_ES_EWAJS,o.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApp should be a non empty string"),H=t,void(z=!0);t.sharedClipboardHostingApp=e.sharedClipboardHostingApp.trim();let r=t.sharedClipboardHostingApp;const n=r.indexOf(R);n>=0&&(r=r.substr(n+1));try{t.sharedClipboardHostingApps=e.sharedClipboardHostingApps?JSON.parse(e.sharedClipboardHostingApps):void 0}catch{a().ULS.traceTag(579737680,o.nh.msoulscat_ES_EWAJS,o.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps JSON parsing failed. String : "+e.sharedClipboardHostingApps)}if(!t.sharedClipboardHostingApps||!Array.isArray(t.sharedClipboardHostingApps)||0===t.sharedClipboardHostingApps.length||t.sharedClipboardHostingApps.some((e=>!e||!e.trim())))return a().ULS.traceTag(596124182,o.nh.msoulscat_ES_EWAJS,o.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps should be a JSON string representing an array with at list one app"),t.sharedClipboardHostingApp=l,t.sharedClipboardHostingApps=[],H=t,void(z=!0);try{t.sharedClipboardHostingEnvironments=e.sharedClipboardHostingEnvironments?JSON.parse(e.sharedClipboardHostingEnvironments):void 0}catch{a().ULS.traceTag(579737681,o.nh.msoulscat_ES_EWAJS,o.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments JSON parsing failed. String : "+e.sharedClipboardHostingEnvironments)}if(!t.sharedClipboardHostingEnvironments||!Array.isArray(t.sharedClipboardHostingEnvironments)||0===t.sharedClipboardHostingEnvironments.length||t.sharedClipboardHostingEnvironments.some((e=>!e||!e.trim())))return a().ULS.traceTag(596124183,o.nh.msoulscat_ES_EWAJS,o.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments should be a JSON string representing an array with at list one environment"),t.sharedClipboardHostingApp=l,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],H=t,void(z=!0);if(t.sharedClipboardHostingApps.indexOf(t.sharedClipboardHostingApp)<0){if(t.sharedClipboardHostingApp===r)return a().ULS.traceTag(596124184,o.nh.msoulscat_ES_EWAJS,o.kp.Error,`sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '${t.sharedClipboardHostingApp}' should be listed in sharedClipboardHostingApps`),t.sharedClipboardHostingApp=l,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],H=t,void(z=!0);if(t.sharedClipboardHostingApps.indexOf(r)<0)return a().ULS.traceTag(596124185,o.nh.msoulscat_ES_EWAJS,o.kp.Error,`sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '${t.sharedClipboardHostingApp}' or '${r}' should be listed in sharedClipboardHostingApps`),t.sharedClipboardHostingApp=l,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],H=t,void(z=!0)}t.whitelistOriginComponents=!0,H=t,z=!0}(e)}()}function B(){return{whitelistOriginComponents:!1,sharedClipboardHostingApp:l,sharedClipboardHostingApps:[],sharedClipboardHostingEnvironments:[],sharedClipboardSchemaVersion:U,sharedClipboardExpirationInMinutes:J,clipboardPromiseTimeoutInMinutes:N,remoteLoggerPath:l}}const K="://",q="http",X="https",Q=".",Z="/",Y=":",ee=new RegExp("^\\d+$");let te,re,ne=!1;function oe(e){if(!e)throw new b(l,"origin");const t=e.trim().toLowerCase();let r=l,n=t.split(K,3);if(!n||0===n.length||!n[0]||n[0]!==q&&n[0]!==X)throw new y("Missing protocol","origin",e);if(1===n.length)throw new y("Missing domain","origin",e);if(n.length>2)throw new y(`'${K}' should appear once`,"origin",e);let i=n[1];if(!i)throw new y("Missing domain","origin",e);if(r=n[0]+K,i=i.trim(),n=i.trim().split(Z,3),!n||0===n.length||!n[0]||!n[0].trim())throw new y("Missing domain","origin",e);if(n.length>2)throw new y("The last part of the origin should be the domain","origin",e);if(2===n.length&&n[1])throw new y("The last part of the origin should be the domain","origin",e);if(n=i.split(Y,3),!n||0===n.length||!n[0]||!n[0].trim())throw new y("Missing domain","origin",e);if(n.length>2||2===n.length&&(!n[1]||!n[1].trim()))throw new y("The last part of the origin should be the domain and an optional port number","origin",e);if(i=n[0].trim(),r+=i,2===n.length){const t=n[1].trim(),o=ee.exec(t);if(!o||1!==o.length)throw new y("Invalid port number","origin",e);const i=Number(t);if(isNaN(i))throw new y("Invalid port number","origin",e);r+=Y+t}return a().ULS.traceTag(596452423,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`getValidatedOrigin: origin = '${e}'; validated origin = '${r}'`),r}function ie(e){ce();const t=oe(e),r=oe(function(){let e=l;return window&&window.location&&window.location.origin?(e=window.location.origin,e||(e=l)):(a().ULS.traceTag(595932950,o.nh.msoulscat_ES_EWAJS,o.kp.Warning,`windowLocation.getWindowLocation: is window exist: ${!!window}. is window.location exist: ${window&&!!window.location}. is window.location.origin exist ${window&&window.location&&!!window.location.origin}. is window.location.protocol exist ${window&&window.location&&!!window.location.protocol}. is window.location.hostname exist ${window&&window.location&&!!window.location.hostname}. is window.location.port exist ${window&&window.location&&!!window.location.port}`),window&&window.location&&window.location.protocol&&window.location.hostname&&(e=window.location.protocol+"//"+window.location.hostname,window.location.origin=e)),{origin:e}}().origin);if(t===r)return t;if(!V().whitelistOriginComponents)throw new C(`validateOriginForReceivedMessage: Caller origin '${e}' doesn't match the current window's origin '${r}'`);const n=ae(t),i=ae(r);if(n.protocol!==i.protocol)throw new C(`validateRemoteWindowOrigin: Caller origin's protocol '${n.protocol}' doesn't match the current window origin's protocol '${i.protocol}'`);if(n.environment!==i.environment)throw new C(`validateRemoteWindowOrigin: Caller origin's environment '${n.environment}' doesn't match the current window origin's environment '${i.environment}'`);return t}function ae(e){ce();const t=e.split(K,2),r=t[0],n=se(t[1]),o={protocol:r};if(o.environment=le(e,n,re),n.length<=o.environment.length+1)throw new y("Missing app component","origin",e);if(n.charAt(o.environment.length)!==Q)throw new y("Missing a domain separator after the environment component","origin",e);const i=n.substr(o.environment.length+Q.length);if(o.app=le(e,i,te),o.app.length<i.length&&i.charAt(o.app.length)!==R)throw new y(`When the Office Online app name is not the domain prefix, '${R}' should precede it`,"origin",e);return o}function se(e){if(!e)throw new b(l,"stringToReverse");const t=e.length;let r=l;for(let n=t-1;n>=0;n-=1)r+=e.charAt(n);return r}function le(e,t,r){if(!t)throw new b(l,"reversedValidatedHostname");if(!r)throw new b(l,"reversedStringsToLengthMap");const n=t.length,o=Object.keys(r).filter((e=>{const o=r[e];return o<=n&&t.substr(0,o)===e}));if(o&&o.length>0)return se(o[0]);throw new y("Invalid origin","validatedOrigin",e)}function ce(){if(ne)return;const e=V();e.whitelistOriginComponents&&(te=de(e.sharedClipboardHostingApps),re=de(e.sharedClipboardHostingEnvironments),ne=!0)}function de(e){const t={};return e&&Array.isArray(e)&&0!==e.length?(e.forEach((e=>{t[se(e)]=e.length})),t):t}function ue(){return(Math.random()+1).toString(36).substring(7)}class pe{}function ge(e){return"get"===e||"set"===e||"init"===e}pe.localStorageData="localStorage/data",pe.localStorageMetadata="localStorage/metadata",pe.initIframe="initIframe";const he=function(e){if(!e)throw new b(l,"clipboardOperationMessage");if(!e.id||0===e.id.trim().length)throw new b(l,"id");if(!e.operationCode)throw new b(l,"operationCode");if(!e.destination)throw new b(l,"destination");if(!ge(e.operationCode))throw new y(l,"operationCode",e.operationCode);if("set"!==e.operationCode&&e.clipboardItemsData)throw new y(`'${e.operationCode}' expects no clipboard items`,"clipboardItemsData")};function fe(e,t,r,n,o){const i={id:e,operationCode:t,failed:r,error:n,clipboardItemsData:o};return me(i),i}const me=function(e){if(!e)throw new b(l,"clipboardOperationResultMessage");const t=["failed","error","clipboardItemsData","operationCode","id","userHash"];let r=!1;for(const n of t)if(e.hasOwnProperty(n)){r=!0;break}if(!r)throw new S("clipboardOperationResultMessage has no valid key");if(!e.id||0===e.id.trim().length)throw a().ULS.traceTag(553747865,o.nh.msoulscat_ES_EWAJS,o.kp.Warning,`Missing argument 'id'. keys: ${JSON.stringify(Object.keys(e))}, isConstructorObject: ${e.constructor===Object}, operationCode: ${e.operationCode}, id: ${e.id}, failed: ${e.failed}, error: ${e.error}.`),new b(l,"id");if(!e.operationCode)throw new b(l,"operationCode");if("getresult"!==e.operationCode&&"setresult"!==e.operationCode&&"initresult"!==e.operationCode&&"unknownresult"!==e.operationCode&&"getMetadata_longPollingresult"!==e.operationCode)throw new y(l,"operationCode",e.operationCode);if(e.failed){if(!e.error)throw new y(`A failed '${e.operationCode}' operation expects a non-empty error argument`,"error");if(e.clipboardItemsData)throw new y(`A failed '${e.operationCode}' operation does not expect a clipboardItemsData argument`,"clipboardItemsData")}else{if(e.error)throw new y(`'${e.operationCode}' expects an empty error argument`,"error");if("unknownresult"===e.operationCode)throw new y(`'${e.operationCode}' can only be used with a failure message`,"operationCode")}if("getresult"===e.operationCode||"getMetadata_longPollingresult"===e.operationCode){if(!e.failed&&!e.clipboardItemsData)throw new y(`'${e.operationCode}' expects a clipboardItems argument`,"clipboardItemsData")}else if(e.clipboardItemsData)throw new y(`'${e.operationCode}' expects no clipboardItemsData argument`,"clipboardItemsData")};function we(e){if(!e||0===e.trim().length)throw new y(l,"className",e);return(()=>{let t=!1;function r(t){return`${e}:${t}: already disposed`}return{dispose:function(){t=!0},logIfDisposed:function(e){return t&&a().ULS.traceTag(596456217,o.nh.msoulscat_ES_EWAJS,o.kp.Warning,r(e)),t},throwIfDisposed:function(e){if(t)throw new C(r(e))}}})()}class Se{initialize(e){return e.then((e=>(this.clipboardStorage=e,a().ULS.traceTag(596453007,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`Clipboard strategy type '${this.clipboardStrategyType}' was initialized.`),Promise.resolve(this))),(e=>(a().ULS.traceTag(596453008,o.nh.msoulscat_ES_EWAJS,f(e)?o.kp.Info:o.kp.Error,`Failed to initialize clipboard strategy type '${this.clipboardStrategyType}'. Error: ${o.Wp.getStringifiedError(e)}`),Promise.reject(e))))}set(e,t){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.clipboardStorage){const e="ClipboardStrategyBase.set: this.clipboardStorage should be defined";return a().ULS.shipAssertTag(596121485,o.nh.msoulscat_ES_EWAJS,!1,e),Promise.reject(new v(d.ClipboardStrategyNotInitialized))}return this.clipboardDataProcessor&&this.clipboardDataProcessor.preSetProcess(e),this.clipboardStorage.set(e,t)}catch(e){return Promise.reject(new v(d.SetClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).set`,e))}}get(e){try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.clipboardStorage){const e="ClipboardStrategyBase.get: this.clipboardStorage should be defined";return a().ULS.shipAssertTag(596121486,o.nh.msoulscat_ES_EWAJS,!1,e),Promise.reject(new v(d.ClipboardStrategyNotInitialized))}return this.clipboardStorage.get(e).then((e=>(this.clipboardDataProcessor&&this.clipboardDataProcessor.postGetProcess(e),Promise.resolve(e)))).catch((t=>{throw a().ULS.traceTag(507848131,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`ClipboardStrategyBase.get - Failed to get clipboard items. Command id: ${e.id}, Error: ${o.Wp.getStringifiedError(t)}`),t}))}catch(e){return Promise.reject(new v(d.GetClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).get`,e))}}onSystemClipboardChangedExternally(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.clipboardStorage?this.clipboardCapabilities.systemClipboard?Promise.resolve():this.clipboardStorage.set(P(),e):(a().ULS.shipAssertTag(595882508,o.nh.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.clipboardStorage should be defined"),Promise.reject(new v(d.ClipboardStrategyNotInitialized)))}catch(e){return Promise.reject(new v(d.ClearClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).onSystemClipboardChangedExternally`,e))}}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.clipboardStorage&&this.clipboardStorage.dispose(),this.disposableImplementationExtension.dispose())}constructor(e,t,r){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.clipboardDataProcessor=r,this.disposableImplementationExtension=we(`${e}`)}}const be=!!window.performance&&!!window.performance.now&&!!window.performance.timing;function ye(e){let t=e;return t&&0!==t.trim().length||(t=ue()),new Ee(t)}function Ce(){return be?window.performance.now():Date.now()}function _e(e){return be?new Date(e+window.performance.timing.navigationStart):new Date(e)}function ve(e,t,r){if(!r)throw new b(l,"creationTimestamp");return`${e?"Fulfilled":"Still unfulfilled"} after ${e?t?t-r:"?":Ce()-r}ms`}class Ee{fulfilled(){return this.isFulfilled}resolve(e){this.markAsFulfilled("resolve"),this.internalResolve?this.internalResolve(e):a().ULS.traceTag(596456257,o.nh.msoulscat_ES_EWAJS,o.kp.Warning,`Deferred promise - resolve: the resolve for deferred promise #${this.sequenceId} with id '${this.id}' is not tracked with a callback`)}reject(e){this.markAsFulfilled("reject"),this.internalReject?this.internalReject(e):a().ULS.traceTag(596456260,o.nh.msoulscat_ES_EWAJS,o.kp.Warning,`Deferred promise - reject: the reject for deferred promise #${this.sequenceId} with id '${this.id}' is not tracked with a callback`)}markAsFulfilled(e){this.fulfillmentCheck(e)||(this.isFulfilled=!0,this.rejected="resolve"!==e,this.fulfillmentTimestamp=Ce(),a().ULS.traceTag(596456261,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`Deferred promise: marking promise #${this.sequenceId} with id '${this.id}' as fulfilled (${this.rejected?"rejected":"resolved"}). ${ve(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)}`))}fulfillmentCheck(e){return a().ULS.traceTag(596456258,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`Deferred promise: asked to ${e} deferred promise #${this.sequenceId} with id '${this.id}'`),this.isFulfilled&&a().ULS.traceTag(596456259,o.nh.msoulscat_ES_EWAJS,o.kp.Warning,`Deferred promise: cannot ${e} deferred promise #${this.sequenceId} with id '${this.id}' since it was ${this.rejected?"rejected":"resolved"} already on ${_e(this.fulfillmentTimestamp)}. ${ve(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)}`),this.isFulfilled}constructor(e){this.isFulfilled=!1,this.fulfillmentTimestamp=void 0,this.rejected=!1,this.id=function(e){if(!e)throw new b(l,"id");const t=e.trim().toLowerCase();if(0===t.length)throw new y(l,"id");return t}(e),Ee.sequenceId+=1,this.sequenceId=Ee.sequenceId,this.creationTimestamp=Ce(),a().ULS.traceTag(596456225,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`Deferred promise: creating deferred promise #${this.sequenceId} with id '${this.id}' on ${_e(this.creationTimestamp)}`),this.promise=new Promise(((e,t)=>{a().ULS.traceTag(596456226,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`Deferred promise: registering callback for promise #${this.sequenceId} with id '${this.id}' on ${_e(Ce())}`),this.internalResolve=e,this.internalReject=t}))}}Ee.sequenceId=0;const Te="initmessageid",Ie="unknownmessageid",Pe="CreatorOrigin";function Ae(e){if(!e)throw new b(l,"remoteWindow");if(!("window"in e)||!e.window)throw new b(l,"remoteWindow.window");if(!("windowOrigin"in e)||!e.windowOrigin)throw new b(l,"remoteWindow.windowOrigin");const t=ie(e.windowOrigin);return{window:e.window,windowOrigin:t}}class Me{get disposableImplementationExtension(){return this._disposableImplementationExtension}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(function(e){if(!e||!Array.isArray(e)||0===e.length)return void a().ULS.traceTag(596456214,o.nh.msoulscat_ES_EWAJS,o.kp.Warning,"rethrowAfterAllActions: no actions to execute");let t,r=0;if(e.forEach((e=>{if(r+=1,e)try{e()}catch(e){a().ULS.traceTag(596456216,o.nh.msoulscat_ES_EWAJS,o.kp.Warning,`rethrowAfterAllActions: callback action #${r} threw an exception: ${e.message}`),t||(t=new C(e.message,e))}else a().ULS.traceTag(596456215,o.nh.msoulscat_ES_EWAJS,o.kp.Warning,`rethrowAfterAllActions: callback action #${r} is empty`)})),t)throw t}([()=>{this.sender&&this.sender.dispose()},()=>{this.receiver&&this.receiver.dispose()}]),this.disposableImplementationExtension.dispose())}postMessage(e){if(this.disposableImplementationExtension.throwIfDisposed("postMessage"),!e)throw new b(l,"outgoingMessage");if(!this.sender){const e="WindowRPCBase::postMessage - this.sender should be defined";throw a().ULS.shipAssertTag(596121484,o.nh.msoulscat_ES_EWAJS,!1,e),new C(e)}this.sender.postMessage(e)}constructor(e,t,r,n){this.serializer=e,this.deserializer=t,this.remoteWindow=r,this.remoteWindow=r,this._disposableImplementationExtension=we(n)}}function Le(){return Oe}const Oe={addEventListener:(e,t)=>window.addEventListener(e,t),removeEventListener:(e,t)=>window.removeEventListener(e,t)},We="message";class xe{dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(Le().removeEventListener(We,this.windowMessageHandler),this.disposableImplementationExtension.dispose())}shouldFilterMessageEvent(e){try{if(!e.origin||!e.source)return a().ULS.traceTag(596452370,o.nh.msoulscat_ES_EWAJS,o.kp.Info,"Window RPC Receiver: ignoring messages from unspecified window sources."),!0;if(e.source===window)return a().ULS.traceTag(596452371,o.nh.msoulscat_ES_EWAJS,o.kp.Verbose,"Window RPC Receiver: ignoring messages from this window to itself."),!0;if(this.remoteWindow.window&&e.source!==this.remoteWindow.window)return a().ULS.traceTag(596452372,o.nh.msoulscat_ES_EWAJS,o.kp.Verbose,"Window RPC Receiver: ignoring messages from windows other than the assigned remote window."),!0;if(e.origin.toLowerCase()!==this.remoteWindow.windowOrigin)return a().ULS.traceTag(596452373,o.nh.msoulscat_ES_EWAJS,o.kp.Verbose,"Window RPC Receiver: ignoring messages from windows with an origin that differs from remote window origin."),!0}catch(e){return!0}return!1}onMessageReceived(e){if(this.shouldFilterMessageEvent(e))return;let t;try{t=this.deserializer.deserialize(e.data)}catch(e){a().ULS.traceTag(596452374,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`Window RPC Receiver: unable to deserialize incoming message. ${o.Wp.getStringifiedError(e)}`);try{this.handler.handleDeserializationError(e)}catch(e){a().ULS.traceTag(596452184,o.nh.msoulscat_ES_EWAJS,o.kp.Error,`Window RPC Receiver: unable to handle deserialization error. ${o.Wp.getStringifiedError(e)}`)}return}if(t)try{this.handler.handleMessage(t).catch((e=>{a().ULS.traceTag(595985880,o.nh.msoulscat_ES_EWAJS,o.kp.Error,`Window RPC Receiver: unable to process incoming message. ${o.Wp.getStringifiedError(e)}`)}))}catch(e){a().ULS.traceTag(596452186,o.nh.msoulscat_ES_EWAJS,o.kp.Error,`Window RPC Receiver: unable to process incoming message. ${o.Wp.getStringifiedError(e)}`)}else a().ULS.traceTag(596452185,o.nh.msoulscat_ES_EWAJS,o.kp.Error,"Window RPC Receiver: the incoming message is empty")}constructor(e,t,r){if(this.deserializer=e,this.handler=t,this.windowMessageHandler=e=>this.onMessageReceived(e),!e)throw new b(l,"deserializer");if(!t)throw new b(l,"handler");if(!r)throw new b(l,"windowRPC");this.disposableImplementationExtension=we("WindowRPCReceiverInternal"),this.remoteWindow=Ae(r.remoteWindow),Le().addEventListener(We,this.windowMessageHandler)}}class ke{postMessage(e){if(!e)throw new b(l,"outgoingMessage");if(!this.remoteWindow.window)throw new C("Configure the remote window");if(!this.remoteWindow.window.postMessage)throw new C("The remote window does not support postMessage");const t=this.serializer.serialize(e);E(this.remoteWindow.window,t,this.remoteWindow.windowOrigin)}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(e,t,r=!1){if(this.serializer=e,this.delayedQueueEnabled=r,!e)throw new b(l,"serializer");if(!t)throw new b(l,"windowRPC");this.disposableImplementationExtension=we("WindowRPCSenderInternal"),this.remoteWindow=Ae(t.remoteWindow)}}const De="OfficeOnlineCCP_",Fe=De+"Metadata_",$e=De+"Data_",Re="_LocalStorageChangedFlag";function je(e){return Fe+e}var Ue;!function(e){e[e.Started=1]="Started",e[e.SynchronousPhaseCompleted=2]="SynchronousPhaseCompleted",e[e.Completed=3]="Completed"}(Ue||(Ue={}));class Je{get(e){this.disposableImplementationExtension.throwIfDisposed("get"),a().ULS.traceTag(595716238,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`localStorageClipboardStorage.get: commandParameters.id='${e?e.id:l}'`);const t=localStorage.getItem(this.localStorageKey);if(!t)return Promise.resolve(P());try{const e=JSON.parse(t);if(!e||0===A(e))return Promise.resolve(P());const r=L(e);return Promise.resolve(r)}catch(e){return Promise.resolve(P())}}set(e,t){this.disposableImplementationExtension.throwIfDisposed("set"),a().ULS.traceTag(595716239,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`localStorageClipboardStorage.set: item count=${M(e)}'; commandParameters.id='${t?t.id:l}'`),0===M(e)?localStorage.removeItem(this.localStorageKey):localStorage.setItem(this.localStorageKey,JSON.stringify(e.getData()));const r=`${this.localStorageKey+Re}`,n=ue();return a().ULS.traceTag(595654546,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`localStorageClipboardStorage.set: set local storage value. eventFalgKey = ${r}. eventFlagValue = ${n}`),localStorage.setItem(r,n),Promise.resolve()}getSupportedDataFormats(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[T,"text/html","data/shadow-workbook"]}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(e){this.localStorageKey=e;try{if(!localStorage)throw new Error("LocalStorageClipboardStorage.ctor: localStorage == null")}catch(e){throw new v(d.LocalStorageInitilizationInaccessible,"LocalStorageClipboardStorage.ctor: failed access to localStorage",e)}if(!e)throw new v(d.LocalStorageInitilizationNoKey,"LocalStorageClipboardStorage.ctor: localStorageKey must be defined");this.clipboardStorageType=x.LocalStorage,this.disposableImplementationExtension=we("LocalStorageClipboardStorage")}}function Ne(e){return a().ULS.traceTag(595716236,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`Attempting to create clipboard strategy type '${c.LocalStorage}' with localStorageKey: '${e}'`),(new He).initialize(function(e){try{a().ULS.traceTag(595716237,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`Attempting to create clipboard storage type '${x.LocalStorage}'`);const t=new Je(e);return Promise.resolve(t)}catch(e){return Promise.reject(e)}}(e))}class He extends Se{constructor(e){super(c.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},e)}}class ze{onStorageChanged(e){a().ULS.shipAssertTag(595716249,o.nh.msoulscat_ES_EWAJS,null!=e,"e should not be null"),a().ULS.traceTag(595716288,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`LocalStorageKeyChangeTracker.onStorageChanged:got storage change event. e.key = ${e.key}. localStorageKeyToWatch = ${this.localStorageKeyToWatch}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),e.key===this.localStorageKeyToWatch&&(this.raiseMetadataChangedEvent(),a().ULS.traceTag(595716289,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`LocalStorageKeyChangeTracker.onStorageChanged: raised metadata change event. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged()||this.waitForLocalStorageValueToChange(this.maxTimeToWaitInMilliseconds).then((()=>{this.raiseMetadataChangedEvent()}),(()=>{a().ULS.traceTag(595716295,o.nh.msoulscat_ES_EWAJS,o.kp.Warning,"LocalStorageKeyChangeTracker.onStorageChanged: got rejected promise.")})))}raiseMetadataChangedEvent(){return a().ULS.traceTag(595715525,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: starting raiseMetadataChangedEvent. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.clipboardStrategy.get({userHash:0}).then((e=>{this.listener(e),a().ULS.traceTag(595716232,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: sent message. lastLocalStorageValue = ${this.lastLocalStorageValue}`)}),(e=>{a().ULS.traceTag(595716233,o.nh.msoulscat_ES_EWAJS,o.kp.Warning,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: failed to get metadata from clipboardStorage")}))}isLocalStorageValueChanged(){const e=localStorage.getItem(this.localStorageKeyToWatch),t=this.lastLocalStorageValue!==e;return a().ULS.traceTag(595715526,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`LocalStorageKeyChangeTracker.isLocalStorageValueChanged: lastLocalStorageValue = ${this.lastLocalStorageValue}. currentLocalStorageValue = ${e}`),this.lastLocalStorageValue=e,t}waitForLocalStorageValueToChange(e){if(a().ULS.traceTag(595715527,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: start waitForLocalStorageValueToChange. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged())return a().ULS.traceTag(595715528,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving because value was changed. lastLocalStorageValue = ${this.lastLocalStorageValue}`),Promise.resolve();const t=ye(),r=new Date,n=setInterval((()=>{const i=(new Date).getTime()-r.getTime();a().ULS.traceTag(595715529,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: call by setInterval. startTime = ${r}. elapseTime = ${i}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged()?(clearInterval(n),a().ULS.traceTag(595716234,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving. startTime = ${r}. elapseTime = ${i}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),t.resolve()):i>e&&(clearInterval(n),a().ULS.traceTag(595716235,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: rejecting. startTime = ${r}. elapseTime = ${i}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),t.reject())}),200);return t.promise}constructor(e,t,r){this.localStorageKeyToWatch=e,this.clipboardStrategy=t,this.listener=r,this.maxTimeToWaitInMilliseconds=2e3,this.lastLocalStorageValue=null,window.addEventListener("storage",this.onStorageChanged.bind(this)),this.raiseMetadataChangedEvent()}}r(382);new RegExp("(\n\r)|(\r\n)|(\r)","g"),new RegExp("(\t)","g");var Ve,Ge=r(633);!function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(Ve||(Ve={}));const Be=1e3;var Ke,qe;(qe=Ke||(Ke={}))[qe.Error=10]="Error",qe[qe.Warning=15]="Warning",qe[qe.Important=20]="Important",qe[qe.Info=50]="Info",qe[qe.Verbose=100]="Verbose",qe[qe.Spam=200]="Spam";class Xe{handleTrace(e){e.message.length>Xe.messageMaxChars&&(e.message=e.message.substr(0,Xe.messageMaxChars-Xe.trimmedMessage.length)+Xe.trimmedMessage),this.logCache.push(e),(this.logCache.length>Xe.uploadTriggerSize||e.level===Ke.Error)&&this.triggerUploadAsync()}constructor(e,t,r){this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=()=>{this.triggerUpload(!1,!1)},this.flush=()=>{this.triggerUploadAsync()},this.triggerUploadAsync=()=>{window.setTimeout((()=>this.triggerUpload(!0,!0)),0)},this.triggerUpload=(e,t)=>{window.clearTimeout(this.timeoutId),this.logCache.length>0&&(this.uploadId+=1,function(e,t,r){if(!t)return;const n=window.navigator;if(n&&n.sendBeacon)try{return void n.sendBeacon(t,e)}catch{}!function(e,t,r){const n=new XMLHttpRequest;n.readyState!==XMLHttpRequest.UNSENT&&n.readyState!==XMLHttpRequest.DONE||(n.open("POST",t,r),n.send(e))}(e,t,r)}(function(e,t,r,n){const o=[],i=e.map((e=>function(e,t,r){const n={};if(n.G=e.tag,n.T=e.timestamp-t,n.M=e.message,n.C=e.category,e.correlationId){let t=r.findIndex((t=>t===e.correlationId));t<0&&(t=r.push(e.correlationId)-1),n.I=t}const o=e.type*Be+e.level;return n.D=o,n}(e,n,o))),a=function(e,t,r,n,o){const i={};return i.T=e,i.L=t,i.S=r,i.I=n,o&&o.length>0&&(i.W=o),i.V=1,i}(n,i,t,r,o);return JSON.stringify(a)}(this.logCache,this.userSessionId,this.uploadId,this.timestampBase),this.remoteUrlEndpoint,t),this.logCache=[],this.timestampBase=Date.now()),e&&(this.timeoutId=window.setTimeout(this.triggerUploadAsync,Xe.uploadCadenceInMsSec))},this.userSessionId=e;let n=t+"?usid="+e;void 0!==r&&r.forEach(((e,t)=>{n+="&"+t+"="+e})),this.remoteUrlEndpoint=n,window.setTimeout((()=>this.triggerUpload(!0,!0)),0)}}function Qe(e,t,r,n,o,i){if(n>Ke.Info)return;const a={timestamp:Date.now(),category:r,tag:t,level:n,type:Ve.Trace,message:o,correlationId:i};e.handleTrace(a)}Xe.messageMaxChars=3072,Xe.uploadCadenceInMsSec=3e4,Xe.uploadTriggerSize=30,Xe.trimmedMessage="... [Trimmed]";class Ze{handleMessage(e,t){return e&&e.operationCode in this._handlers?this._handlers[e.operationCode].handleMessage(e,t):et(t,new v(d.UnsupportedOperationCode,`Operation code '${e?e.operationCode:"incomingMessage is null"}' is unsupported`))}addMessageHandler(e,t){e?e in this._handlers?a().ULS.shipAssertTag(595944464,o.nh.msoulscat_ES_EWAJS,!1,`BaseMessageHandler.addMessageHandler: handle for operation: ${e} already exist`):this._handlers[e]=t:a().ULS.shipAssertTag(595944463,o.nh.msoulscat_ES_EWAJS,!1,"BaseMessageHandler.addMessageHandler: expected operationCode to be defined")}constructor(){this._handlers={}}}class Ye extends Ze{get(e,t){const r={userHash:e.userHash};return this.clipboardStrategy.get(r).then((e=>(t.clipboardItemsData=e.getData(),Promise.resolve(t))),(e=>et(t,e)))}set(e,t){const r={userHash:e.userHash};let n;return e.clipboardItemsData&&(n=e.clipboardItemsData),this.clipboardStrategy.set(L(n),r).then((()=>Promise.resolve(t)),(e=>et(t,e)))}constructor(e){super(),this.clipboardStrategy=e,this.nameForTelemetry=`ClipboardStrategyMessageHandler_StrategyType_${e.clipboardStrategyType}`,this.addMessageHandler("get",{handleMessage:this.get.bind(this)}),this.addMessageHandler("set",{handleMessage:this.set.bind(this)})}}function et(e,t){return tt(e,t),Promise.resolve(e)}function tt(e,t){e.failed=!0,e.error=o.Wp.getStringifiedError(t)}class rt extends Me{handleMessage(e){if(a().ULS.traceTag(596452360,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`RPC Server - handleMessage: incomingMessage.id='${e&&e.id}'; incomingMessage.operationCode='${e&&e.operationCode}'; incomingMessage.clipboardItems.length=${A(e&&e.clipboardItemsData)}`),this.windowRPCServerState.isInitializationPending()&&e&&"init"===e.operationCode)return a().ULS.traceTag(596129562,o.nh.msoulscat_ES_EWAJS,o.kp.Info,"The clipboard strategy is not initialized yet. Once it's done, it'll send an 'initresult' message."),Promise.resolve();const t=e&&e.id?e.id:Ie,r=!e||!e.operationCode||!ge(e.operationCode),n={id:t,failed:r,error:void 0,operationCode:r?"unknownresult":`${e.operationCode}result`};return this.routeOperation(e,n).then((e=>this.postMessage(e))).catch((e=>(a().ULS.traceTag(596452182,o.nh.msoulscat_ES_EWAJS,o.kp.Error,`RPC Server - handleMessage: unable to send result message. Sending a failure message. ${o.Wp.getStringifiedError(e)}`),n.clipboardItemsData=void 0,tt(n,e),this.postMessage(n)))).catch((e=>(a().ULS.traceTag(596452183,o.nh.msoulscat_ES_EWAJS,o.kp.Error,`RPC Server - handleMessage: unable to send failure result message. ${o.Wp.getStringifiedError(e)}`),Promise.reject(e))))}routeOperation(e,t){if(this.windowRPCServerState.isInitializationPending())return et(t,new v(d.SelectClipboardStrategy,"A clipboard strategy had not been selected and initialized yet"));if(!this.windowRPCServerState.isInitializedSuccessfully())return et(t,this.windowRPCServerState.getClipboardInitError());if("init"===e.operationCode)return Promise.resolve(t);const r=this.windowRPCServerState.getMessageHandler(e.destination);return r?r.handleMessage(e,t):et(t,new v(d.SelectClipboardStrategy,"messageHandler does not exist"))}handleDeserializationError(e){return this.postMessage({id:Ie,failed:!0,error:o.Wp.getStringifiedError(e),operationCode:"unknownresult"}).catch((e=>{a().ULS.traceTag(596451867,o.nh.msoulscat_ES_EWAJS,o.kp.Error,`RPC Server - handleDeserializationError: unable to send failure result message. ${o.Wp.getStringifiedError(e)}`)}))}postMessage(e){try{return super.postMessage(e),Promise.resolve()}catch(t){return Promise.reject(new C(`Unable to post message for operation '${e&&e.operationCode?e.operationCode:l}'`,t))}}constructor(e,t,r,n){if(super(t,e,r,"WindowRPCServerInternal"),this.windowRPCServerState=n,!n)throw new v(d.CreateWindowRPCServer,"windowRPCServerState is undefined.");this.receiver=function(e,t,r){return new xe(e,t,r)}(e,this,this),this.sender=function(e,t){return new ke(e,t)}(t,this)}}class nt{sendMessage(e){if(this.windowRPCServer){const t=fe(ue(),this.operationCode,!1,void 0,e);this.windowRPCServer.postMessage(t)}}constructor(e,t){this.windowRPCServer=e,this.operationCode=t}}class ot extends nt{raiseMetadataChangedEvent(e){this.sendMessage(e.getData())}constructor(e,t,r){super(r,"getMetadata_longPollingresult"),this.localStorageKeyChangeTracker=new ze(t,e,this.raiseMetadataChangedEvent.bind(this))}}function it(e,t){if(!t)return Promise.resolve(!1);const r=function(e,t){try{const r=window.parent,n=e;if(!n)throw new b("remoteWindowOrigin is undefined","remoteWindowOrigin");return new rt(function(e){if(!e)throw new b(l,"validator");return{deserialize:t=>function(e,t){if(!e)throw new b(l,"incomingMessage");if(!t)throw new b(l,"validator");if(0===e.length)throw new y("An empty message is invalid","incomingMessage");const r=e.trim();if(0===r.length)throw new y("A message cannot contain only spaces","incomingMessage");let n;try{n=JSON.parse(r)}catch(t){throw new y("Deserialization failed","incomingMessage",`Contains ${e.length.toString()} characters`,t)}if(!n)throw new y("Deserialization returned nothing","incomingMessage");return t(n),n}(t,e)}}(he),function(e){if(!e)throw new b(l,"validator");return{serialize:t=>function(e,t){if(!e)throw new b(l,"outgoingMessage");if(!t)throw new b(l,"validator");return t(e),function(e){let t;try{t=JSON.stringify(e)}catch(t){throw new y("Serialization failed","outgoingMessage",`${Object.keys(e).length} properties`,t)}return a().ULS.traceTag(596452375,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`The length of the serialized message is ${t.length}`),t}(e)}(t,e)}}(me),{window:r,windowOrigin:n},t)}catch(e){return void a().ULS.shipAssertTag(595981475,o.nh.msoulscat_ES_EWAJS,!1,`createWindowRPCServer failed with exception: ${o.Wp.getStringifiedError(e)}`)}}(e,at);if(!r)return a().ULS.traceTag(595947554,o.nh.msoulscat_ES_EWAJS,o.kp.Error,"initModuleState: Failed to create windowRPCServer"),Promise.resolve(!1);const n=ye(Te);return st={initMessageIdUniqueRunningSuffix:1,initializationDeferredPromise:n,windowRPCServer:r},st.initializationDeferredPromise.promise.then((()=>function(){const e=ct();if(a().ULS.shipAssertTag(595947555,o.nh.msoulscat_ES_EWAJS,!!e,"sendClipboardInitializationSuccessResult: windowRPCServer must be defined"),!e)return Promise.reject(new C("sendClipboardInitializationSuccessResult cannot post a message since WindowRPCServer could not be created"));const t=fe(dt(),"initresult",!1);return e.postMessage(t)}()),(e=>function(e){const t=ct();if(a().ULS.shipAssertTag(595947584,o.nh.msoulscat_ES_EWAJS,!!t,"sendClipboardInitializationFailureResult: windowRPCServer must be defined"),!t)return Promise.reject(new C("sendClipboardInitializationFailureResult cannot post a message since WindowRPCServer could not be created"));const r=fe(dt(),"initresult",!0,o.Wp.getStringifiedError(e));return t.postMessage(r)}(e))).catch((()=>{})),t.then((e=>(st&&(st.metadataDataChangedMessageSender=new ot(e.metadataClipboardStrategy,e.localStorageMetadataKeyToWatch,r)),function(e){const t=Object.keys(e).map((t=>`Name: ${t}, handlerName: ${e[t]&&e[t].nameForTelemetry}`)).join(", ");a().ULS.traceTag(595947585,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`markInitializationSuccess: Created and initialized ClipboardStrategies '${t}'`),a().ULS.shipAssertTag(595947586,o.nh.msoulscat_ES_EWAJS,!!st,"markInitializationSuccess: windowRPCServerInternalState must be defined"),st&&(st.clipboardOperationMessageHandlerMap=e,st.clipboardInitError=void 0,st.clipboardInitTimestamp=Date.now(),st.initializationDeferredPromise&&st.initializationDeferredPromise.resolve())}(e.messageHandlers),Promise.resolve(!0))),(e=>(function(e){a().ULS.traceTag(595947587,o.nh.msoulscat_ES_EWAJS,f(e)?o.kp.Info:o.kp.Error,"markInitializationFailure: Failed to initialize ClipboardStrategies"),a().ULS.shipAssertTag(595947588,o.nh.msoulscat_ES_EWAJS,!!st,"markInitializationFailure: windowRPCServerInternalState must be defined"),st&&(st.clipboardOperationMessageHandlerMap=void 0,st.clipboardInitError=e,st.clipboardInitTimestamp=Date.now(),st.initializationDeferredPromise&&st.initializationDeferredPromise.reject(st.clipboardInitError))}(e),Promise.resolve(!1))))}const at={getMessageHandler:function(e){if(st)if(e)if(st.clipboardOperationMessageHandlerMap){if(e in st.clipboardOperationMessageHandlerMap)return st.clipboardOperationMessageHandlerMap[e];a().ULS.shipAssertTag(595945237,o.nh.msoulscat_ES_EWAJS,!1,`getMessageHandler: ${e} is not part of ClipboardStrategyMap`)}else a().ULS.shipAssertTag(595945236,o.nh.msoulscat_ES_EWAJS,!1,"getMessageHandler: clipboardOperationMessageHandlerMap is not initialized");else a().ULS.shipAssertTag(595945235,o.nh.msoulscat_ES_EWAJS,!1,"getMessageHandler: expected destination to be defined")},isInitializationPending:lt,isInitializedSuccessfully:function(){return!!st&&(!lt()&&!!st.clipboardOperationMessageHandlerMap)},getClipboardInitError:function(){if(st)return st.clipboardInitError}};let st;function lt(){return!st||!st.initializationDeferredPromise||!st.initializationDeferredPromise.fulfilled()}function ct(){if(st)return st.windowRPCServer}function dt(){if(!st)return l;const e=st.initMessageIdUniqueRunningSuffix;return st.initMessageIdUniqueRunningSuffix+=1,`${Te}${e}`}function ut(){s(new Ge.ConsoleLogger),G();let e=o.Wp.getQueryParameterByName(window.location.href,Pe)||"";if(!e)throw new b("remoteWindowOrigin is undefined","remoteWindowOrigin");e=ie(e);try{const t=o.Wp.getQueryParameterByName(window.location.href,$)||"";let r=o.Wp.getQueryParameterByName(window.location.href,F)||"";if(!r){const n=V().remoteLoggerPath;n&&t&&(r=`${e}${n}`)}r&&s(function(e,t){const r=function(e,t){const r=new Xe(e,t);return{sendTraceTag:(e,t,n,o)=>Qe(r,e,t,n,o,""),shipAssertTag:(e,t,n,o)=>{n&&Qe(r,e,t,Ke.Error,o,"")},debugAssertTag:()=>{throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:r.flush,flushOnClose:r.flushOnClose,setCorrelationId:()=>{}}}(t,e);return{assertTag:(e,t,n,o)=>r.shipAssertTag(e,t,!n,o),shipAssertTag:(e,t,n,o)=>r.shipAssertTag(e,t,!n,o),debugTraceTag:r.sendTraceTag,traceTag:r.sendTraceTag}}(r,t))}catch{}const t=V().sharedClipboardSchemaVersion,r=function(e){return $e+e}(t),n=Ne(r).then((e=>{const r=je(t),n=function(e){return je(e)+Re}(t);return Ne(r).then((t=>{const r={};return r[pe.localStorageData]=new Ye(e),r[pe.localStorageMetadata]=new Ye(t),{messageHandlers:r,localStorageMetadataKeyToWatch:n,dataClipboardStrategy:e,metadataClipboardStrategy:t}}))}));return it(e,n)}sharedClipboard=n}();
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/sharedClipboard.min.js.map/74b0273ca62b0d53481366b8a4a7f64a/sharedClipboard.min.js.map