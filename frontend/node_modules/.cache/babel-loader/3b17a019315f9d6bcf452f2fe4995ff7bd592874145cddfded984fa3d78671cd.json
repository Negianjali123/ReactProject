{"ast":null,"code":"var _jsxFileName = \"/home/anegi/react/frontend/src/Pages/home.js\",\n  _s = $RefreshSig$();\nimport { useState, useContext, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport UserContext from \"../Component/context/UserContext\";\nimport api from '../utils/api';\nimport { encryptData } from '../utils/crypto';\nimport { SigninFormSchema } from '../schema/loginSchema';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function Home() {\n  _s();\n  const navigate = useNavigate();\n  const [formData, setFormData] = useState({\n    email: '',\n    password: ''\n  });\n  const [fieldErrors, setfieldErrors] = useState({\n    email: '',\n    password: ''\n  });\n  const {\n    encryptedName,\n    setEncryptedName\n  } = useContext(UserContext);\n  const handleChange = e => {\n    setFormData({\n      ...formData,\n      [e.target.name]: e.target.value\n    });\n  };\n  useEffect(() => {\n    localStorage.removeItem('user');\n    setEncryptedName(null);\n    const checkSession = async () => {\n      try {\n        const response = await api.get('/session-check');\n        if (response.data.success) {\n          //   console.log(\"Session is valid:\", response.data);\n        }\n      } catch (error) {\n        console.error(\"Session invalid or error:\", error);\n      }\n    };\n    checkSession();\n  }, [encryptedName]);\n  const handleSubmit = async e => {\n    e.preventDefault();\n    const result = SigninFormSchema.safeParse(formData);\n    if (!result.success) {\n      const fieldErrors = {\n        email: '',\n        password: ''\n      };\n      result.error.issues.forEach(err => {\n        fieldErrors[err.path[0]] = err.message;\n      });\n      setfieldErrors(fieldErrors);\n      return;\n    }\n    try {\n      //   setLoading(true);\n      await api.post('http://localhost:7000/login', formData, {\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      }).then(res => {\n        let username = res.data.user.name;\n        let name = encryptData(username);\n        setEncryptedName(name);\n        navigate('/user/dashboard');\n      }).catch(err => {\n        var _err$response;\n        let data = (_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.data;\n        if (data.email) {\n          setfieldErrors({\n            email: data.message,\n            password: ''\n          });\n        } else if (data.password) {\n          setfieldErrors({\n            email: '',\n            password: data.message\n          });\n        } else {\n          setfieldErrors({\n            email: '',\n            password: ''\n          }); // fallback\n        }\n      });\n    } catch (err) {\n      console.error('Network error:', err);\n    }\n  };\n  // if (loading) return <div className=\"loader\" ></div>;\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-flex vh-100 justify-content-center align-items-center\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card-tittle mt-3\",\n          children: /*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-center titlename\",\n            children: \"Sign In\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card-body\",\n          children: /*#__PURE__*/_jsxDEV(\"form\", {\n            action: \"/login\",\n            method: \"POST\",\n            className: \"space-y-6 form-floating\",\n            onSubmit: handleSubmit,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mb-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                htmlFor: \"InputEmail\",\n                className: \"form-label\",\n                children: \"Email address\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 87,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                className: \"form-control\",\n                id: \"InputEmail\",\n                name: \"email\",\n                \"aria-describedby\": \"emailHelp\",\n                value: formData.email,\n                onChange: handleChange\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 88,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                id: \"emailHelp\",\n                className: \"form-text\",\n                children: \"We'll never share your email with anyone else.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 89,\n                columnNumber: 33\n              }, this), fieldErrors.email && /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"validationerror mt-1\",\n                children: fieldErrors.email\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 90,\n                columnNumber: 55\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 86,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mb-5\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                htmlFor: \"InputPassword\",\n                className: \"form-label\",\n                children: \"Password\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 93,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                className: \"form-control\",\n                id: \"InputPassword\",\n                onChange: handleChange,\n                value: formData.password,\n                name: \"password\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 94,\n                columnNumber: 33\n              }, this), fieldErrors.password && /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"validationerror mt-1\",\n                children: fieldErrors.password\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 95,\n                columnNumber: 58\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 92,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              className: \"btn btnhover w-100 mb-3\",\n              children: \"Submit\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 97,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 13\n    }, this)\n  }, void 0, false);\n}\n_s(Home, \"skY0dyHtRqRz/IIXEd0Z+2yuexE=\", false, function () {\n  return [useNavigate];\n});\n_c = Home;\nvar _c;\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"names":["useState","useContext","useEffect","useNavigate","UserContext","api","encryptData","SigninFormSchema","jsxDEV","_jsxDEV","Fragment","_Fragment","Home","_s","navigate","formData","setFormData","email","password","fieldErrors","setfieldErrors","encryptedName","setEncryptedName","handleChange","e","target","name","value","localStorage","removeItem","checkSession","response","get","data","success","error","console","handleSubmit","preventDefault","result","safeParse","issues","forEach","err","path","message","post","headers","then","res","username","user","catch","_err$response","children","className","fileName","_jsxFileName","lineNumber","columnNumber","action","method","onSubmit","htmlFor","id","onChange","type","_c","$RefreshReg$"],"sources":["/home/anegi/react/frontend/src/Pages/home.js"],"sourcesContent":["import { useState,useContext, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport UserContext from \"../Component/context/UserContext\";\nimport api from '../utils/api'\nimport { encryptData } from '../utils/crypto'\nimport { SigninFormSchema } from '../schema/loginSchema'\n\n\nexport default function Home() {\n    const navigate = useNavigate();\n    const [formData, setFormData] = useState({ email: '', password: '' });\n    const [fieldErrors, setfieldErrors] = useState({ email: '', password: '' })\n    const { encryptedName,setEncryptedName } = useContext(UserContext);\n    \n    const handleChange = (e) => {\n        setFormData({ ...formData, [e.target.name]: e.target.value });\n    };\n\n    useEffect(() => {\n        localStorage.removeItem('user');\n        setEncryptedName(null);\n        const checkSession = async () => {\n\n          try {\n            const response = await api.get('/session-check');\n            if (response.data.success) {\n            //   console.log(\"Session is valid:\", response.data);\n            }\n          } catch (error) {\n            console.error(\"Session invalid or error:\", error);\n          }\n        };\n        checkSession();\n      }, [encryptedName]);\n      \n      \n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        const result = SigninFormSchema.safeParse(formData);\n        if (!result.success) {\n            const fieldErrors = { email: '', password: '' };\n            result.error.issues.forEach((err) => {\n                fieldErrors[err.path[0]] = err.message;\n            });\n            setfieldErrors(fieldErrors);\n            return;\n        }\n        try {\n            //   setLoading(true);\n            await api.post('http://localhost:7000/login', formData, {\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n            })\n                .then(res => {\n                    let username = res.data.user.name;\n                    let name = encryptData(username)\n                    setEncryptedName(name);\n                    navigate('/user/dashboard');\n                })\n                .catch(err => {\n                    let data = err.response?.data\n                    if (data.email) {\n                        setfieldErrors({ email: data.message, password: '' });\n                    } else if (data.password) {\n                        setfieldErrors({ email: '', password: data.message });\n                    } else {\n                        setfieldErrors({ email: '', password: '' }); // fallback\n                    }\n                })\n        }\n        catch (err) {\n            console.error('Network error:', err);\n        }\n    };\n    // if (loading) return <div className=\"loader\" ></div>;\n    return (\n        <>\n            <div className=\"d-flex vh-100 justify-content-center align-items-center\">\n                <div className=\"card\" >\n                    <div className=\"card-tittle mt-3\">\n                        <h3 className=\"text-center titlename\">Sign In</h3>\n                    </div>\n                    <div className=\"card-body\">\n                        <form action=\"/login\" method=\"POST\" className=\"space-y-6 form-floating\" onSubmit={handleSubmit}>\n                            <div className=\"mb-3\">\n                                <label htmlFor=\"InputEmail\" className=\"form-label\">Email address</label>\n                                <input className=\"form-control\" id=\"InputEmail\" name='email' aria-describedby=\"emailHelp\" value={formData.email} onChange={handleChange} />\n                                <div id=\"emailHelp\" className=\"form-text\">We'll never share your email with anyone else.</div>\n                                {fieldErrors.email && <p className=\"validationerror mt-1\">{fieldErrors.email}</p>}\n                            </div>\n                            <div className=\"mb-5\">\n                                <label htmlFor=\"InputPassword\" className=\"form-label\">Password</label>\n                                <input className=\"form-control\" id=\"InputPassword\" onChange={handleChange} value={formData.password} name='password' />\n                                {fieldErrors.password && <p className=\"validationerror mt-1\">{fieldErrors.password}</p>}\n                            </div>\n                            <button type=\"submit\" className=\"btn btnhover w-100 mb-3\">Submit</button>\n\n                        </form>\n                    </div>\n                </div>\n            </div>\n        </>\n    )\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}